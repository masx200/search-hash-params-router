{"version":3,"file":"index.mjs","sources":["../node_modules/.pnpm/@masx200+event-emitter-target@1.1.7/node_modules/@masx200/event-emitter-target/dist/index.js","../src/createrouter/hashrouter/gethashparams.ts","../src/createrouter/hashrouter/gethashhref.ts","../src/createrouter/hashrouter/sethashparams.ts","../src/createrouter/hashrouter/transformhashparams.ts","../src/createrouter/searchrouter/getsearchparams.ts","../src/createrouter/searchrouter/getsearchhref.ts","../src/createrouter/searchrouter/setsearchparams.ts","../src/createrouter/searchrouter/transformsearchparams.ts","../src/createrouter/createbaserouter.ts","../src/createrouter/hashrouter/createhashrouter.ts","../src/createrouter/searchrouter/createsearchrouter.ts","../src/components/react/create-react-link.tsx"],"sourcesContent":["function t(){return{}.toString.call({[Symbol.toStringTag]:\"EventEmitterTarget\"})}function e(t){if(\"string\"!=typeof t&&\"symbol\"!=typeof t)throw new TypeError(\" EVENTNAME expected: string | symbol;but invalid :\"+t)}function n(t){if(\"function\"!=typeof t)throw new TypeError(\" EVENTLISTENER expected: (event?: any) => void;but invalid:\"+t)}function o(){const o=new Map,r=new WeakMap;function i(t){let e=o.get(t);return e||(e=new Set,o.set(t,e)),e}function c(t){e(t),o.has(t)&&i(t).clear()}function s(t,n){e(t),o.has(t)&&i(t).forEach(t=>{Promise.resolve().then(()=>{t(n)})})}function u(t,o){e(t),n(o),i(t).add(o)}function f(t,e){i(t).delete(e)}function a(t,o){e(t),n(o),f(t,o),function(t,e){const n=i(t);let o=r.get(e);o&&n.delete(o)}(t,o)}function l(){return[...o].map(([t,e])=>[t,[...e]])[Symbol.iterator]()}return{[Symbol.toPrimitive]:t,[Symbol.toStringTag]:\"EventEmitterTarget\",[Symbol.iterator]:l,entries:l,listenerCount:function(t){return e(t),o.has(t)?i(t).size:0},clear:c,removeAllListeners:c,on:u,addListener:u,off:a,removeListener:a,once:function(t,o){e(t),n(o);let i=!1,c=r.get(o);if(!c){const e=n=>{f(t,e),f(t,o),i||(i=!0,o(n))};c=e,r.set(o,c)}f(t,o),u(t,c)},emit:s,dispatch:s,eventNames:function(){return[...o.keys()]},listeners:function(t){return e(t),o.has(t)?[...i(t)]:[]}}}const r=(t=>{var e=Symbol(),n=new Function(\"return async()=>{}\")()();function r(){const t=o();return this&&this instanceof r?(Object.assign(this,t),this):Reflect.construct(r,[])}return Reflect.set(r,e,n),r})();export default r;\n//# sourceMappingURL=index.js.map\n","export function gethashparams() {\n    return (\n        (location.hash &&\n            Object.fromEntries(new URLSearchParams(location.hash.slice(1)))) ||\n        {}\n    );\n}\n","//@ts-ignore\nimport { gethashparams } from \"./gethashparams.ts\";\n\nexport function gethashhref(\n    to:\n        | Record<string, string>\n        | ((old: Record<string, string>) => Record<string, string>)\n): string {\n    if (!to) {\n        throw new TypeError(to);\n    }\n    let params: {\n        [k: string]: string;\n    } = gethashparams();\n    let url = new URL(location.href);\n\n    if (\"function\" === typeof to) {\n        params = to(params);\n        url.hash = String(new URLSearchParams({ ...to }));\n        return url.href;\n    }\n    if (\"object\" === typeof to) {\n        params = to;\n        url.hash = String(new URLSearchParams({ ...to }));\n        return url.href;\n    }\n    throw new TypeError(to);\n}\n","export function sethashparams(opt: Record<string, string>) {\n    const oldhash = location.hash;\n    let url = new URL(location.href);\n\n    url.hash = String(new URLSearchParams({ ...opt }));\n\n    if (oldhash === url.hash) {\n        return;\n    }\n    history.pushState({}, \"\", url.href);\n\n    window.dispatchEvent(new Event(\"hashchange\"));\n}\n","//@ts-ignore\nimport { gethashparams } from \"./gethashparams.ts\"; //@ts-ignore\nimport { sethashparams } from \"./sethashparams.ts\";\nexport function transformhashparams(\n    opt: (old: Record<string, string>) => Record<string, string>\n) {\n    sethashparams(opt(gethashparams()));\n}\n","export function getsearchparams() {\n    return (\n        (location.search &&\n            Object.fromEntries(new URL(location.href).searchParams)) ||\n        {}\n    );\n}\n","//@ts-ignore\nimport { getsearchparams } from \"./getsearchparams.ts\";\n\nexport function getsearchhref(\n    to:\n        | Record<string, string>\n        | ((old: Record<string, string>) => Record<string, string>)\n): string {\n    if (!to) {\n        throw new TypeError(to);\n    }\n    let params: {\n        [k: string]: string;\n    } = getsearchparams();\n    let url = new URL(location.href);\n\n    if (\"function\" === typeof to) {\n        params = to(params);\n        url.search = String(new URLSearchParams({ ...to }));\n        return url.href;\n    }\n    if (\"object\" === typeof to) {\n        params = to;\n        url.search = String(new URLSearchParams({ ...to }));\n        return url.href;\n    }\n    throw new TypeError(to);\n}\n","export function setsearchparams(opt: Record<string, string>) {\n    const oldsearch = location.search;\n    let url = new URL(location.href);\n\n    url.search = String(new URLSearchParams({ ...opt }));\n\n    if (oldsearch === url.search) {\n        return;\n    }\n    history.pushState({}, \"\", url.href);\n\n    window.dispatchEvent(new Event(\"popstate\"));\n}\n","//@ts-ignore\nimport { getsearchparams } from \"./getsearchparams.ts\"; //@ts-ignore\nimport { setsearchparams } from \"./setsearchparams.ts\";\nexport function transformsearchparams(\n    opt: (old: Record<string, string>) => Record<string, string>\n) {\n    setsearchparams(opt(getsearchparams()));\n}\n","//@ts-ignore\n\nimport EventEmitterTargetClass from \"@masx200/event-emitter-target\";\n//@ts-ignore\nimport { gethashhref } from \"./hashrouter/gethashhref.ts\";\n//@ts-ignore\nimport { gethashparams } from \"./hashrouter/gethashparams.ts\";\n//@ts-ignore\nimport { sethashparams } from \"./hashrouter/sethashparams.ts\";\n//@ts-ignore\nimport { transformhashparams } from \"./hashrouter/transformhashparams.ts\";\nimport { Router } from \"./Router\";\nimport { RouteRecord } from \"./RouteRecord\";\n//@ts-ignore\nimport { getsearchhref } from \"./searchrouter/getsearchhref.ts\";\n//@ts-ignore\nimport { getsearchparams } from \"./searchrouter/getsearchparams.ts\"; //\n//@ts-ignore\nimport { setsearchparams } from \"./searchrouter/setsearchparams.ts\"; //@ts-ignore\nimport { transformsearchparams } from \"./searchrouter/transformsearchparams.ts\";\n\nexport function createBaseRouter({\n    routes = [],\n    type,\n}: {\n    routes: RouteRecord[];\n    type: \"search\" | \"hash\";\n}): Router {\n    const eventname = \"search\" === type ? \"popstate\" : \"hashchange\";\n\n    const emitter = EventEmitterTargetClass();\n\n    const changelistener = () => {\n        const params = \"hash\" === type ? gethashparams() : getsearchparams();\n        instance.emit(\"param\", params);\n    };\n\n    window.addEventListener(eventname, changelistener);\n    const router = {\n        href: \"hash\" === type ? gethashhref : getsearchhref,\n\n        set: \"hash\" === type ? sethashparams : setsearchparams,\n        get: \"hash\" === type ? gethashparams : getsearchparams,\n        transform:\n            \"hash\" === type ? transformhashparams : transformsearchparams,\n        [Symbol.toStringTag]: \"search\" === type ? \"SearchRouter\" : \"HashRouter\",\n        routes: routes,\n    };\n\n    const instance: Router = (() => {\n        const ins = {};\n        const objarr = [emitter, router];\n\n        objarr.forEach((obj) => {\n            Reflect.ownKeys(obj).forEach((key) => {\n                Reflect.set(ins, key, Reflect.get(obj, key));\n            });\n        });\n\n        return ins as Router;\n    })();\n\n    return instance as Router;\n}\n","//@ts-ignore\nimport { createBaseRouter } from \"../createbaserouter.ts\";\nimport { Router } from \"../Router\";\nimport { RouteRecord } from \"../RouteRecord\";\nexport function createHashRouter({\n    routes = [],\n}: {\n    routes: RouteRecord[];\n}): Router {\n    return createBaseRouter({ routes, type: \"hash\" });\n}\n","//@ts-ignore\n\nimport { createBaseRouter } from \"../createbaserouter.ts\";\nimport { Router } from \"../Router\";\nimport { RouteRecord } from \"../RouteRecord\";\n\nexport function createSearchRouter({\n    routes = [],\n}: {\n    routes: RouteRecord[];\n}): Router {\n    return createBaseRouter({ routes, type: \"search\" });\n}\n","import { Router } from \"../../createrouter/Router\";\nexport function createReactLink({\n    router,\n    forwardRef,\n    createElement,\n}: {\n    router: Router;\n    forwardRef: typeof import(\"react\").forwardRef;\n    createElement: typeof import(\"react\").createElement;\n}) {\n    console.log(router, forwardRef, createElement);\n    return forwardRef<\n        unknown,\n        {\n            component?: string | import(\"react\").ComponentType<any>;\n            target?: string;\n            onClick?: (event: import(\"react\").MouseEvent) => void;\n            to:\n                | Record<string, string>\n                | ((old: Record<string, string>) => Record<string, string>);\n        }\n    >(\n        (\n            {\n                component: Component = \"a\",\n                to,\n                onClick,\n                children,\n                target,\n                ...rest\n            },\n            forwardedRef\n        ) => {\n            const href: string = router.href(to);\n            const newclick = (event: import(\"react\").MouseEvent) => {\n                try {\n                    if (onClick) {\n                        onClick(event);\n                    }\n                } catch (ex) {\n                    event.preventDefault();\n                    throw ex;\n                }\n                if (\n                    !event.defaultPrevented &&\n                    // onClick prevented default\n                    event.button === 0 &&\n                    // ignore everything but left clicks\n                    (!target || target === \"_self\") &&\n                    // let browser handle \"target=_blank\" etc.\n                    !isModifiedEvent(event)\n                    // ignore clicks with modifier keys\n                ) {\n                    event.preventDefault();\n                    navigate(router, to);\n                }\n            };\n            const props = {\n                ...rest,\n                ref: forwardedRef,\n                href,\n                onClick: newclick,\n                target,\n            };\n            return <Component {...props}>{children}</Component>;\n        }\n    );\n}\nfunction isModifiedEvent(event: import(\"react\").MouseEvent) {\n    return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\nfunction navigate(\n    router: Router,\n    to:\n        | Record<string, string>\n        | ((old: Record<string, string>) => Record<string, string>)\n) {\n    if (!to) {\n        throw new TypeError(to);\n    }\n    if (\"function\" === typeof to) {\n        router.transform(to);\n        return;\n    }\n    if (\"object\" === typeof to) {\n        router.set(to);\n        return;\n    }\n    throw new TypeError(to);\n}\n"],"names":["toprimitive","toString","call","Symbol","toStringTag","gethashparams","location","hash","Object","fromEntries","URLSearchParams","slice","gethashhref","to","TypeError","params","url","URL","href","String","sethashparams","opt","oldhash","history","pushState","window","dispatchEvent","Event","transformhashparams","getsearchparams","search","searchParams","getsearchhref","setsearchparams","oldsearch","transformsearchparams","createBaseRouter","routes","type","eventname","emitter","EventEmitterTargetClass","addEventListener","instance","emit","router","set","get","transform","ins","forEach","obj","Reflect","ownKeys","key","createHashRouter","createSearchRouter","createReactLink","forwardRef","createElement","component","Component","onClick","children","target","rest","forwardedRef","props","ref","event","ex","preventDefault","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","navigate"],"mappings":"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"}